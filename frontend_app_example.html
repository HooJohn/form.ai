import React, { useState, useEffect } from 'react';

// Tailwind CSS is assumed to be available in the environment.
// For demonstration, we'll define our color palette based on the design document.
const colors = {
  primary: '#1A4D8C', // æ·±è“
  secondary: '#4A90E2', // æµ…è“
  accent: '#FF9900',   // æ©™è‰²
  background: '#FFFFFF', // ç™½è‰²
  text: '#333333',     // æ·±ç°
  highlight: '#E0F2F7', // æ·¡è“è‰²é«˜äº®
};

// Mock Data for Prototype
const mockTemplates = [
  {
    id: 'template_001',
    schoolLogo: 'https://placehold.co/40x40/4A90E2/FFFFFF?text=PLK',
    schoolName: 'ä¿è‰¯å±€é¦¬éŒ¦æ˜å¤«äººç« é¦¥ä»™ä¸­å­¸',
    titleZH: 'ä¸­ä¸€è‡³ä¸­å››æ’ç­ç”Ÿç”³è«‹è¡¨',
    titleEN: 'Application Form for S1-S4 Transfer Student',
    grade: 'ä¸­ä¸€è‡³ä¸­å››',
    lastUpdated: '2025-07-01',
    description: 'é€‚ç”¨äºS1-S4æ’ç­ç”³è¯·ï¼ŒåŒ…å«ä¸ªäººã€å®¶åº­åŠå­¦ä¸šä¿¡æ¯ã€‚',
  },
  {
    id: 'template_002',
    schoolLogo: 'https://placehold.co/40x40/FF9900/FFFFFF?text=HKU',
    schoolName: 'é¦™æ¸¯å¤§å­¸é™„å±¬å­¸é™¢',
    titleZH: 'æ–°ç”Ÿå…¥å­¸ç”³è«‹è¡¨',
    titleEN: 'New Student Admission Form',
    grade: 'ä¸­å…­',
    lastUpdated: '2025-06-15',
    description: 'å¤§å­¸é™„å±¬å­¸é™¢å…¥å­¸ç”³è«‹ï¼Œéœ€æä¾›DSEæˆç¸¾ã€‚',
  },
  {
    id: 'template_003',
    schoolLogo: 'https://placehold.co/40x40/1A4D8C/FFFFFF?text=CCC',
    schoolName: 'ä¸­è¯åŸºç£æ•™æœƒå”å’Œå°å­¸',
    titleZH: 'å°ä¸€å…¥å­¸ç”³è«‹è¡¨',
    titleEN: 'Primary One Admission Form',
    grade: 'å°ä¸€',
    lastUpdated: '2025-07-05',
    description: 'å°ä¸€å­¸ä½ç”³è«‹ï¼ŒåŒ…å«å®¶é•·è³‡æ–™åŠé¢è©¦å®‰æ’ã€‚',
  },
];

const mockFormData = {
  sections: [
    {
      id: 'applicant_info',
      titleZH: 'A. ç”³è«‹è€…è³‡æ–™',
      titleEN: 'A. Applicant Information',
      fields: [
        { id: 'english_name', labelZH: 'è‹±æ–‡å§“å', labelEN: 'English Name', value: 'CHEN CHUN YUK VIKE', type: 'text', confidence: 95 },
        { id: 'chinese_name', labelZH: 'ä¸­æ–‡å§“å', labelEN: 'ä¸­æ–‡å§“å', value: 'é™³ä¿Šæ—­', type: 'text', confidence: 95 },
        { id: 'hkid_number', labelZH: 'é¦™æ¸¯èº«ä»½è­‰è™Ÿç¢¼', labelEN: 'HKID Number', value: 'S291164 (9)', type: 'text', confidence: 90 },
        { id: 'date_of_birth', labelZH: 'å‡ºç”Ÿæ—¥æœŸ', labelEN: 'Date of Birth (DD/MM/YYYY)', value: '04/03/2009', type: 'date', confidence: 85 },
        { id: 'sex', labelZH: 'æ€§åˆ¥', labelEN: 'Sex', value: 'ç”·', type: 'radio', options: ['ç”·', 'å¥³'], confidence: 98 },
        { id: 'place_of_birth', labelZH: 'å‡ºç”Ÿåœ°æ–¹', labelEN: 'Place of Birth', value: 'é¦™æ¸¯', type: 'text', confidence: 92 },
        { id: 'nationality', labelZH: 'åœ‹ç±', labelEN: 'Nationality', value: 'ä¸­åœ‹', type: 'text', confidence: 90 },
        { id: 'home_language', labelZH: 'å®¶åº­å¸¸ç”¨èªè¨€', labelEN: 'Spoken Language at Home', value: 'æ™®é€šè©±', type: 'text', confidence: 80 }, // Lower confidence for demo
        { id: 'mobile_phone', labelZH: 'æ‰‹æé›»è©±', labelEN: 'Mobile Phone', value: '67693062', type: 'tel', confidence: 95 },
        { id: 'residential_address', labelZH: 'ä½å€', labelEN: 'Residential Address', value: 'é¦™æ¸¯ä¹é¾æ—ºè§’èŠ±åœ’è¡—132-136è™Ÿå‹å’Œå¤§æ¨“3C', type: 'textarea', confidence: 88 },
      ],
    },
    {
      id: 'parent_info',
      titleZH: 'B. å®¶é•·åŠç›£è­·äººè³‡æ–™',
      titleEN: 'B. Parent/Guardian Information',
      fields: [
        { id: 'mother_name_zh', labelZH: 'æ¯è¦ªä¸­æ–‡å§“å', labelEN: 'Mother Chinese Name', value: 'æœ±é‡‘é³³', type: 'text', confidence: 95 },
        { id: 'mother_occupation', labelZH: 'æ¯è¦ªè·æ¥­', labelEN: 'Mother Occupation', value: 'é†«ç”Ÿ', type: 'text', confidence: 90 },
        { id: 'father_name_zh', labelZH: 'çˆ¶è¦ªä¸­æ–‡å§“å', labelEN: 'Father Chinese Name', value: 'é™³å»ºæ³¢', type: 'text', confidence: 95 },
        { id: 'father_occupation', labelZH: 'çˆ¶è¦ªè·æ¥­', labelEN: 'Father Occupation', value: 'å»ºç¯‰å·¥ç¨‹å¸«', type: 'text', confidence: 90 },
      ],
    },
    {
      id: 'school_attended',
      titleZH: 'C. æ›¾/ç¾æ­£å°±è®€å­¸æ ¡åç¨±',
      titleEN: 'C. School(s) Attended / Attending',
      fields: [
        { id: 'school1_name', labelZH: 'å­¸æ ¡åç¨±', labelEN: 'School Name', value: 'å°‡è»æ¾³é¦™å³¶ä¸­å­¸', type: 'text', confidence: 92 },
        { id: 'school1_from', labelZH: 'ç”± (æœˆ/å¹´)', labelEN: 'From (MM/YYYY)', value: '09/2024', type: 'text', confidence: 90 },
        { id: 'school1_to', labelZH: 'è‡³ (æœˆ/å¹´)', labelEN: 'To (MM/YYYY)', value: '07/2025', type: 'text', confidence: 90 },
        { id: 'school1_grade', labelZH: 'ç´šåˆ¥', labelEN: 'Year Level', value: 'ä¸­ä¸‰', type: 'text', confidence: 90 },
      ],
    },
  ],
};

const mockExtractedInfo = {
  'æˆ‘å„¿å­å«å¼ ä¼Ÿï¼Œ2009å¹´3æœˆ4æ—¥å‡ºç”Ÿï¼Œä½åœ¨é¦™æ¸¯ä¹é¾™æ—ºè§’èŠ±å›­è¡—132-136å·å‹å’Œå¤§æ¥¼3Cã€‚': [
    { label: 'å§“å (ä¸­æ–‡)', value: 'å¼ ä¼Ÿ' },
    { label: 'å‡ºç”Ÿæ—¥æœŸ', value: '2009å¹´3æœˆ4æ—¥' },
    { label: 'åœ°å€', value: 'é¦™æ¸¯ä¹é¾™æ—ºè§’èŠ±å›­è¡—132-136å·å‹å’Œå¤§æ¥¼3C' },
  ],
  'æˆ‘å¦ˆå¦ˆæœ±é‡‘å‡¤ï¼ŒèŒä¸šåŒ»ç”Ÿã€‚': [
    { label: 'æ¯äº²å§“å (ä¸­æ–‡)', value: 'æœ±é‡‘å‡¤' },
    { label: 'æ¯äº²èŒä¸š', value: 'åŒ»ç”Ÿ' },
  ],
  'æˆ‘çˆ¸çˆ¸é™ˆå»ºæ³¢ï¼Œå»ºç­‘å·¥ç¨‹å¸ˆã€‚': [
    { label: 'çˆ¶äº²å§“å (ä¸­æ–‡)', value: 'é™ˆå»ºæ³¢' },
    { label: 'çˆ¶äº²èŒä¸š', value: 'å»ºç­‘å·¥ç¨‹å¸ˆ' },
  ]
};

// Shared Header Component
const Header = ({ currentView, setView, language, setLanguage }) => {
  return (
    <header className="bg-white shadow-sm py-4 px-6 flex justify-between items-center rounded-b-lg">
      <div className="flex items-center space-x-4">
        <h1 className="text-xl font-bold text-primary flex items-center">
          <span className="text-2xl mr-2">ğŸ“</span> Form.AI 2.0
        </h1>
        <nav className="hidden md:flex space-x-6">
          <button onClick={() => setView('templateLibrary')} className={`text-text hover:text-primary font-medium ${currentView === 'templateLibrary' ? 'text-primary' : ''}`}>
            {language === 'zh-HK' ? 'æ¨¡æ¿åº«' : language === 'zh-CN' ? 'æ¨¡æ¿åº“' : 'Template Library'}
          </button>
          <button onClick={() => setView('dashboard')} className={`text-text hover:text-primary font-medium ${currentView === 'dashboard' ? 'text-primary' : ''}`}>
            {language === 'zh-HK' ? 'æˆ‘çš„è¡¨æ ¼' : language === 'zh-CN' ? 'æˆ‘çš„è¡¨æ ¼' : 'My Forms'}
          </button>
          <button onClick={() => alert('å‡å­¦é¡¾é—®æœåŠ¡ - æ•¬è¯·æœŸå¾…ï¼')} className="text-text hover:text-primary font-medium">
            {language === 'zh-HK' ? 'å‡å­¸é¡§å•' : language === 'zh-CN' ? 'å‡å­¦é¡¾é—®' : 'Admission Advisor'}
          </button>
          <button onClick={() => alert('å¸®åŠ©ä¸­å¿ƒ - æ•¬è¯·æœŸå¾…ï¼')} className="text-text hover:text-primary font-medium">
            {language === 'zh-HK' ? 'å¹«åŠ©ä¸­å¿ƒ' : language === 'zh-CN' ? 'å¸®åŠ©ä¸­å¿ƒ' : 'Help Center'}
          </button>
        </nav>
      </div>
      <div className="flex items-center space-x-4">
        <select
          className="p-2 rounded-md border border-gray-300 text-sm text-text"
          value={language}
          onChange={(e) => setLanguage(e.target.value)}
        >
          <option value="zh-HK">ä¸­æ–‡ç¹é«”</option>
          <option value="zh-CN">ä¸­æ–‡ç®€ä½“</option>
          <option value="en">English</option>
        </select>
        <button onClick={() => alert('ç”¨æˆ·ç™»å½•/ä¸ªäººä¸­å¿ƒ - æ•¬è¯·æœŸå¾…ï¼')} className="flex items-center space-x-2 text-text hover:text-primary">
          <svg xmlns="http://www.w3.org/2000/svg" className="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5.121 17.804A13.937 13.937 0 0112 16c2.5 0 4.847.655 6.879 1.804M15 10a3 3 0 11-6 0 3 3 0 016 0zm6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
          <span className="hidden md:block">{language === 'zh-HK' ? 'ç™»éŒ„' : language === 'zh-CN' ? 'ç™»å½•' : 'Login'}</span>
        </button>
      </div>
    </header>
  );
};

// Dashboard Component
const Dashboard = ({ setView, language }) => {
  return (
    <div className="p-8 bg-gray-50 min-h-screen font-sans">
      <div className="max-w-7xl mx-auto">
        <h2 className="text-3xl font-semibold text-primary mb-8">
          {language === 'zh-HK' ? 'æ­¡è¿ä½¿ç”¨ Form.AI 2.0' : language === 'zh-CN' ? 'æ¬¢è¿ä½¿ç”¨ Form.AI 2.0' : 'Welcome to Form.AI 2.0'}
        </h2>

        {/* Quick Start */}
        <div className="bg-white p-8 rounded-xl shadow-lg mb-8 border border-gray-200">
          <h3 className="text-2xl font-semibold text-text mb-6">
            {language === 'zh-HK' ? 'å¿«é€Ÿé–‹å§‹' : language === 'zh-CN' ? 'å¿«é€Ÿå¼€å§‹' : 'Quick Start'}
          </h3>
          <div className="flex flex-col md:flex-row space-y-4 md:space-y-0 md:space-x-6">
            <button
              onClick={() => setView('formFilling')}
              className="flex-1 bg-accent text-white py-4 px-6 rounded-xl text-lg font-bold shadow-md hover:bg-orange-600 transition duration-300 ease-in-out transform hover:scale-105"
            >
              {language === 'zh-HK' ? 'ä¸Šè¼‰è¡¨æ ¼é–‹å§‹å¡«å¯«' : language === 'zh-CN' ? 'ä¸Šä¼ è¡¨æ ¼å¼€å§‹å¡«å†™' : 'Upload Form to Start Filling'}
            </button>
            <button
              onClick={() => setView('templateLibrary')}
              className="flex-1 bg-secondary text-white py-4 px-6 rounded-xl text-lg font-bold shadow-md hover:bg-blue-600 transition duration-300 ease-in-out transform hover:scale-105"
            >
              {language === 'zh-HK' ? 'å¾æ¨¡æ¿åº«é¸æ“‡' : language === 'zh-CN' ? 'ä»æ¨¡æ¿åº“é€‰æ‹©' : 'Select from Template Library'}
            </button>
          </div>
        </div>

        {/* My Recent Forms */}
        <div className="bg-white p-8 rounded-xl shadow-lg mb-8 border border-gray-200">
          <h3 className="text-2xl font-semibold text-text mb-6">
            {language === 'zh-HK' ? 'æˆ‘çš„è¿‘æœŸè¡¨æ ¼' : language === 'zh-CN' ? 'æˆ‘çš„è¿‘æœŸè¡¨æ ¼' : 'My Recent Forms'}
          </h3>
          {mockTemplates.slice(0, 2).map((template) => (
            <div key={template.id} className="flex items-center p-4 mb-4 bg-gray-50 rounded-lg shadow-sm border border-gray-100">
              <img src={template.schoolLogo} alt="School Logo" className="w-10 h-10 rounded-full mr-4" />
              <div className="flex-1">
                <p className="font-semibold text-lg text-text">{language === 'zh-HK' ? template.titleZH : language === 'zh-CN' ? template.titleZH : template.titleEN}</p>
                <p className="text-sm text-gray-500">{language === 'zh-HK' ? template.schoolName : language === 'zh-CN' ? template.schoolName : template.schoolName} Â· {language === 'zh-HK' ? 'æœ€è¿‘ç·¨è¼¯' : language === 'zh-CN' ? 'æœ€è¿‘ç¼–è¾‘' : 'Last edited'}: {template.lastUpdated}</p>
              </div>
              <button
                onClick={() => setView('formFilling')}
                className="bg-primary text-white py-2 px-4 rounded-lg text-sm hover:bg-primary-dark transition duration-200"
              >
                {language === 'zh-HK' ? 'ç¹¼çºŒå¡«å¯«' : language === 'zh-CN' ? 'ç»§ç»­å¡«å†™' : 'Continue Filling'}
              </button>
            </div>
          ))}
          <button onClick={() => setView('dashboard')} className="text-primary hover:underline mt-4 text-center block">
            {language === 'zh-HK' ? 'æŸ¥çœ‹æ‰€æœ‰è¡¨æ ¼' : language === 'zh-CN' ? 'æŸ¥çœ‹æ‰€æœ‰è¡¨æ ¼' : 'View All Forms'}
          </button>
        </div>

        {/* Recommended Templates */}
        <div className="bg-white p-8 rounded-xl shadow-lg border border-gray-200">
          <h3 className="text-2xl font-semibold text-text mb-6">
            {language === 'zh-HK' ? 'æ¨è–¦æ¨¡æ¿' : language === 'zh-CN' ? 'æ¨èæ¨¡æ¿' : 'Recommended Templates'}
          </h3>
          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            {mockTemplates.map((template) => (
              <div key={template.id} className="bg-gray-50 p-5 rounded-lg shadow-sm border border-gray-100 flex flex-col items-start">
                <img src={template.schoolLogo} alt="School Logo" className="w-12 h-12 rounded-full mb-3" />
                <h4 className="font-semibold text-lg text-text mb-1">{language === 'zh-HK' ? template.titleZH : language === 'zh-CN' ? template.titleZH : template.titleEN}</h4>
                <p className="text-sm text-gray-500 mb-3">{language === 'zh-HK' ? template.schoolName : language === 'zh-CN' ? template.schoolName : template.schoolName}</p>
                <p className="text-sm text-gray-600 mb-4 flex-grow">{template.description}</p>
                <button
                  onClick={() => setView('formFilling')}
                  className="bg-secondary text-white py-2 px-4 rounded-lg text-sm hover:bg-blue-600 transition duration-200 self-end"
                >
                  {language === 'zh-HK' ? 'é–‹å§‹å¡«å¯«' : language === 'zh-CN' ? 'å¼€å§‹å¡«å†™' : 'Start Filling'}
                </button>
              </div>
            ))}
          </div>
        </div>
      </div>
    </div>
  );
};

// Template Library Component
const TemplateLibrary = ({ setView, language }) => {
  const [searchTerm, setSearchTerm] = useState('');
  const [selectedCategory, setSelectedCategory] = useState('all');
  const [filteredTemplates, setFilteredTemplates] = useState(mockTemplates);

  useEffect(() => {
    let tempTemplates = mockTemplates;

    if (selectedCategory !== 'all') {
      tempTemplates = tempTemplates.filter(t => t.grade.includes(selectedCategory)); // Simplified filter
    }

    if (searchTerm) {
      tempTemplates = tempTemplates.filter(t =>
        t.schoolName.includes(searchTerm) ||
        t.titleZH.includes(searchTerm) ||
        t.titleEN.includes(searchTerm) ||
        t.description.includes(searchTerm)
      );
    }
    setFilteredTemplates(tempTemplates);
  }, [searchTerm, selectedCategory]);

  const categories = [
    { id: 'all', labelZH: 'å…¨éƒ¨', labelEN: 'All' },
    { id: 'ä¸­ä¸€', labelZH: 'ä¸­ä¸€', labelEN: 'S1' },
    { id: 'å°ä¸€', labelZH: 'å°ä¸€', labelEN: 'P1' },
    { id: 'ä¸­ä¸‰', labelZH: 'ä¸­ä¸‰', labelEN: 'S3' },
    { id: 'ä¸­å…­', labelZH: 'ä¸­å…­', labelEN: 'S6' },
  ];

  return (
    <div className="p-8 bg-gray-50 min-h-screen font-sans">
      <div className="max-w-7xl mx-auto">
        <h2 className="text-3xl font-semibold text-primary mb-8">
          {language === 'zh-HK' ? 'æ¨¡æ¿åº«' : language === 'zh-CN' ? 'æ¨¡æ¿åº“' : 'Template Library'}
        </h2>

        <div className="flex flex-col md:flex-row gap-6">
          {/* Left Sidebar for Filters */}
          <div className="w-full md:w-1/4 bg-white p-6 rounded-xl shadow-lg border border-gray-200 h-fit">
            <h3 className="text-xl font-semibold text-text mb-4">
              {language === 'zh-HK' ? 'ç¯©é¸èˆ‡åˆ†é¡' : language === 'zh-CN' ? 'ç­›é€‰ä¸åˆ†ç±»' : 'Filters & Categories'}
            </h3>
            <input
              type="text"
              placeholder={language === 'zh-HK' ? 'æœç´¢æ¨¡æ¿...' : language === 'zh-CN' ? 'æœç´¢æ¨¡æ¿...' : 'Search templates...'}
              className="w-full p-3 mb-4 border border-gray-300 rounded-lg focus:ring-primary focus:border-primary transition duration-200"
              value={searchTerm}
              onChange={(e) => setSearchTerm(e.target.value)}
            />
            <div className="mb-4">
              <p className="font-medium text-gray-700 mb-2">{language === 'zh-HK' ? 'æŒ‰å¹´ç´š' : language === 'zh-CN' ? 'æŒ‰å¹´çº§' : 'By Grade'}</p>
              {categories.map(cat => (
                <button
                  key={cat.id}
                  onClick={() => setSelectedCategory(cat.id)}
                  className={`block w-full text-left py-2 px-3 rounded-lg text-sm mb-1 transition duration-200 ${selectedCategory === cat.id ? 'bg-primary text-white' : 'text-text hover:bg-gray-100'}`}
                >
                  {language === 'zh-HK' ? cat.labelZH : language === 'zh-CN' ? cat.labelZH : cat.labelEN}
                </button>
              ))}
            </div>
          </div>

          {/* Right Content Area for Templates */}
          <div className="w-full md:w-3/4">
            {filteredTemplates.length === 0 ? (
              <p className="text-center text-gray-600 text-lg mt-10">
                {language === 'zh-HK' ? 'æ²’æœ‰æ‰¾åˆ°ç›¸é—œæ¨¡æ¿ã€‚' : language === 'zh-CN' ? 'æ²¡æœ‰æ‰¾åˆ°ç›¸å…³æ¨¡æ¿ã€‚' : 'No templates found.'}
              </p>
            ) : (
              <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-6">
                {filteredTemplates.map((template) => (
                  <div key={template.id} className="bg-white p-6 rounded-xl shadow-lg border border-gray-200 flex flex-col items-start">
                    <div className="flex items-center mb-4">
                      <img src={template.schoolLogo} alt="School Logo" className="w-14 h-14 rounded-full mr-4" />
                      <div>
                        <h4 className="font-semibold text-xl text-text">{language === 'zh-HK' ? template.titleZH : language === 'zh-CN' ? template.titleZH : template.titleEN}</h4>
                        <p className="text-sm text-gray-500">{language === 'zh-HK' ? template.schoolName : language === 'zh-CN' ? template.schoolName : template.schoolName}</p>
                      </div>
                    </div>
                    <p className="text-gray-600 text-sm mb-4 flex-grow">{template.description}</p>
                    <div className="flex justify-between items-center w-full">
                      <span className="text-xs text-gray-400">{language === 'zh-HK' ? 'æ›´æ–°æ–¼' : language === 'zh-CN' ? 'æ›´æ–°äº' : 'Updated'}: {template.lastUpdated}</span>
                      <button
                        onClick={() => setView('formFilling')}
                        className="bg-primary text-white py-2 px-5 rounded-lg text-sm hover:bg-primary-dark transition duration-200 shadow-md"
                      >
                        {language === 'zh-HK' ? 'é–‹å§‹å¡«å¯«' : language === 'zh-CN' ? 'å¼€å§‹å¡«å†™' : 'Start Filling'}
                      </button>
                    </div>
                  </div>
                ))}
              </div>
            )}
          </div>
        </div>
      </div>
    </div>
  );
};

// Form Filling Component
const FormFilling = ({ setView, language }) => {
  const [formData, setFormData] = useState(mockFormData);
  const [smartInput, setSmartInput] = useState('');
  const [extractedInfo, setExtractedInfo] = useState([]);
  const [activeSection, setActiveSection] = useState(mockFormData.sections[0].id);

  const handleFieldChange = (sectionId, fieldId, value) => {
    setFormData(prevData => {
      const newSections = prevData.sections.map(section => {
        if (section.id === sectionId) {
          const newFields = section.fields.map(field =>
            field.id === fieldId ? { ...field, value: value } : field
          );
          return { ...section, fields: newFields };
        }
        return section;
      });
      return { ...prevData, sections: newSections };
    });
  };

  const handleSmartInputChange = (e) => {
    const input = e.target.value;
    setSmartInput(input);
    // Simulate AI extraction based on input
    if (mockExtractedInfo[input]) {
      setExtractedInfo(mockExtractedInfo[input]);
    } else {
      setExtractedInfo([]);
    }
  };

  const handleExtractAndFill = () => {
    // Simulate AI filling based on extractedInfo
    setFormData(prevData => {
      const newSections = prevData.sections.map(section => {
        const newFields = section.fields.map(field => {
          let newValue = field.value;
          extractedInfo.forEach(info => {
            // Very simplified matching logic for demo
            if (field.labelZH.includes(info.label) || field.labelEN.includes(info.label)) {
              newValue = info.value;
            }
          });
          return { ...field, value: newValue };
        });
        return { ...section, fields: newFields };
      });
      return { ...prevData, sections: newSections };
    });
    setSmartInput(''); // Clear input after filling
    setExtractedInfo([]); // Clear extracted info
  };

  const getSectionProgress = (section) => {
    const totalFields = section.fields.length;
    if (totalFields === 0) return 100;
    const filledFields = section.fields.filter(field => field.value && field.value.toString().trim() !== '').length;
    return Math.round((filledFields / totalFields) * 100);
  };

  const getUnfilledFields = () => {
    const unfilled = [];
    formData.sections.forEach(section => {
      section.fields.forEach(field => {
        if (!field.value || field.value.toString().trim() === '') {
          unfilled.push({
            sectionId: section.id,
            fieldId: field.id,
            label: language === 'zh-HK' ? field.labelZH : language === 'zh-CN' ? field.labelZH : field.labelEN,
            sectionTitle: language === 'zh-HK' ? section.titleZH : language === 'zh-CN' ? section.titleZH : section.titleEN,
          });
        }
      });
    });
    return unfilled;
  };

  const unfilledFields = getUnfilledFields();

  return (
    <div className="flex flex-col h-screen bg-gray-50 font-sans">
      {/* Top Bar for Form Filling */}
      <div className="bg-white shadow-sm py-3 px-6 flex justify-between items-center border-b border-gray-200">
        <h2 className="text-lg font-semibold text-primary">
          {language === 'zh-HK' ? 'ä¸­ä¸€è‡³ä¸­å››æ’ç­ç”Ÿç”³è«‹è¡¨' : language === 'zh-CN' ? 'ä¸­ä¸€è‡³ä¸­å››æ’ç­ç”Ÿç”³è¯·è¡¨' : 'Application Form for S1-S4 Transfer Student'}
        </h2>
        <div className="flex items-center space-x-4">
          <span className="text-sm text-gray-600">{language === 'zh-HK' ? 'è‡ªå‹•ä¿å­˜' : language === 'zh-CN' ? 'è‡ªåŠ¨ä¿å­˜' : 'Auto-saved'}</span>
          <button onClick={() => alert('ä¿å­˜æˆåŠŸï¼')} className="bg-gray-200 text-text py-1.5 px-3 rounded-lg text-sm hover:bg-gray-300 transition duration-200">
            {language === 'zh-HK' ? 'æ‰‹å‹•ä¿å­˜' : language === 'zh-CN' ? 'æ‰‹åŠ¨ä¿å­˜' : 'Save'}
          </button>
        </div>
      </div>

      {/* Three-Column Work Area */}
      <div className="flex flex-1 overflow-hidden">
        {/* Left Nav/Overview */}
        <div className="w-1/5 bg-white p-6 border-r border-gray-200 overflow-y-auto shadow-md">
          <h3 className="text-xl font-semibold text-text mb-4">
            {language === 'zh-HK' ? 'è¡¨æ ¼ç›®éŒ„' : language === 'zh-CN' ? 'è¡¨æ ¼ç›®å½•' : 'Form Directory'}
          </h3>
          {formData.sections.map(section => (
            <div key={section.id} className="mb-4">
              <button
                onClick={() => setActiveSection(section.id)}
                className={`w-full text-left p-3 rounded-lg text-base font-medium transition duration-200 ${activeSection === section.id ? 'bg-primary text-white' : 'text-text hover:bg-gray-100'}`}
              >
                {language === 'zh-HK' ? section.titleZH : language === 'zh-CN' ? section.titleZH : section.titleEN}
              </button>
              <div className="w-full bg-gray-200 rounded-full h-2 mt-2">
                <div
                  className="bg-secondary h-2 rounded-full"
                  style={{ width: `${getSectionProgress(section)}%` }}
                ></div>
              </div>
              <span className="text-xs text-gray-500 block mt-1">{getSectionProgress(section)}% {language === 'zh-HK' ? 'å®Œæˆ' : language === 'zh-CN' ? 'å®Œæˆ' : 'Complete'}</span>
            </div>
          ))}

          <div className="mt-6">
            <h4 className="text-lg font-semibold text-text mb-3">
              {language === 'zh-HK' ? 'æœªå®Œæˆ/å¾…ç¢ºèªå­—æ®µ' : language === 'zh-CN' ? 'æœªå®Œæˆ/å¾…ç¡®è®¤å­—æ®µ' : 'Unfilled/Pending Fields'}
            </h4>
            {unfilledFields.length === 0 ? (
              <p className="text-sm text-gray-500">{language === 'zh-HK' ? 'æ‰€æœ‰å­—æ®µå·²å¡«å¯«ï¼' : language === 'zh-CN' ? 'æ‰€æœ‰å­—æ®µå·²å¡«å†™ï¼' : 'All fields filled!'}</p>
            ) : (
              <ul className="list-disc pl-5 text-sm text-gray-700">
                {unfilledFields.slice(0, 5).map((field, index) => ( // Show first 5
                  <li key={index} className="mb-1">
                    <button onClick={() => {
                        setActiveSection(field.sectionId);
                        // In a real app, you'd scroll to the field
                        alert(`è·³è½¬åˆ°: ${field.sectionTitle} - ${field.label}`);
                    }} className="text-secondary hover:underline">
                      {field.label} ({field.sectionTitle})
                    </button>
                  </li>
                ))}
                {unfilledFields.length > 5 && (
                  <li className="text-gray-500">... {language === 'zh-HK' ? 'æ›´å¤š' : language === 'zh-CN' ? 'æ›´å¤š' : 'more'}</li>
                )}
              </ul>
            )}
          </div>
        </div>

        {/* Middle Form Preview & Edit Area */}
        <div className="flex-1 p-6 overflow-y-auto bg-white shadow-lg">
          <div className="max-w-3xl mx-auto border border-gray-200 rounded-xl p-8">
            <h3 className="text-2xl font-bold text-primary mb-6 text-center">
              {language === 'zh-HK' ? 'ä¸­ä¸€è‡³ä¸­å››æ’ç­ç”Ÿç”³è«‹è¡¨' : language === 'zh-CN' ? 'ä¸­ä¸€è‡³ä¸­å››æ’ç­ç”Ÿç”³è¯·è¡¨' : 'Application Form for S1-S4 Transfer Student'}
            </h3>
            <p className="text-sm text-gray-500 mb-8 text-center">
              {language === 'zh-HK' ? 'è«‹é»æ“Šé«˜äº®å€åŸŸé€²è¡Œç·¨è¼¯æˆ–ç¢ºèªã€‚' : language === 'zh-CN' ? 'è¯·ç‚¹å‡»é«˜äº®åŒºåŸŸè¿›è¡Œç¼–è¾‘æˆ–ç¡®è®¤ã€‚' : 'Click highlighted areas to edit or confirm.'}
            </p>

            {formData.sections.map(section => (
              <div key={section.id} className="mb-8 p-6 bg-gray-50 rounded-lg shadow-inner border border-gray-100">
                <h4 className="text-xl font-semibold text-text mb-5 border-b pb-3 border-gray-200">
                  {language === 'zh-HK' ? section.titleZH : language === 'zh-CN' ? section.titleZH : section.titleEN}
                </h4>
                <div className="grid grid-cols-1 md:grid-cols-2 gap-y-5 gap-x-6">
                  {section.fields.map(field => (
                    <div key={field.id} className="relative">
                      <label className="block text-sm font-medium text-gray-700 mb-1">
                        {language === 'zh-HK' ? field.labelZH : language === 'zh-CN' ? field.labelZH : field.labelEN}
                        {field.confidence && field.confidence < 90 && (
                          <span className="ml-2 text-accent text-xs cursor-pointer group relative">
                            <svg xmlns="http://www.w3.org/2000/svg" className="h-4 w-4 inline-block" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            <span className="absolute left-1/2 -translate-x-1/2 bottom-full mb-2 w-48 p-2 text-xs text-white bg-gray-800 rounded-md opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                              AI {language === 'zh-HK' ? 'è­˜åˆ¥ç½®ä¿¡åº¦' : language === 'zh-CN' ? 'è¯†åˆ«ç½®ä¿¡åº¦' : 'confidence'}: {field.confidence}%ã€‚{language === 'zh-HK' ? 'è«‹ç¢ºèªã€‚' : language === 'zh-CN' ? 'è¯·ç¡®è®¤ã€‚' : 'Please confirm.'}
                            </span>
                          </span>
                        )}
                      </label>
                      {field.type === 'radio' ? (
                        <div className="flex space-x-4">
                          {field.options.map(option => (
                            <label key={option} className="inline-flex items-center">
                              <input
                                type="radio"
                                className="form-radio text-primary h-4 w-4"
                                name={field.id}
                                value={option}
                                checked={field.value === option}
                                onChange={(e) => handleFieldChange(section.id, field.id, e.target.value)}
                              />
                              <span className="ml-2 text-text">{option}</span>
                            </label>
                          ))}
                        </div>
                      ) : field.type === 'textarea' ? (
                        <textarea
                          className={`w-full p-2 border rounded-lg focus:ring-primary focus:border-primary transition duration-200 ${field.value ? 'bg-highlight border-secondary' : 'border-gray-300'}`}
                          value={field.value || ''}
                          onChange={(e) => handleFieldChange(section.id, field.id, e.target.value)}
                          rows="3"
                        />
                      ) : (
                        <input
                          type={field.type}
                          className={`w-full p-2 border rounded-lg focus:ring-primary focus:border-primary transition duration-200 ${field.value ? 'bg-highlight border-secondary' : 'border-gray-300'}`}
                          value={field.value || ''}
                          onChange={(e) => handleFieldChange(section.id, field.id, e.target.value)}
                        />
                      )}
                    </div>
                  ))}
                </div>
              </div>
            ))}

            {/* Signature Area */}
            <div className="mb-8 p-6 bg-gray-50 rounded-lg shadow-inner border border-gray-100">
              <h4 className="text-xl font-semibold text-text mb-5 border-b pb-3 border-gray-200">
                {language === 'zh-HK' ? 'G. è²æ˜' : language === 'zh-CN' ? 'G. å£°æ˜' : 'G. Declaration'}
              </h4>
              <p className="text-gray-700 text-sm mb-4">
                {language === 'zh-HK' ? 'æœ¬äººè¬¹æ­¤è²æ˜...' : language === 'zh-CN' ? 'æœ¬äººè°¨æ­¤å£°æ˜...' : 'I declare...'}
              </p>
              <div className="grid grid-cols-1 md:grid-cols-2 gap-y-5 gap-x-6">
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">
                    {language === 'zh-HK' ? 'å­¸ç”Ÿç°½ç½²' : language === 'zh-CN' ? 'å­¦ç”Ÿç­¾ç½²' : 'Signature of Applicant'}
                  </label>
                  <button onClick={() => alert('ç°½åæ¿åŠŸèƒ½ - æ•¬è«‹æœŸå¾…ï¼')} className="w-full bg-white border border-gray-300 rounded-lg py-8 text-gray-400 flex items-center justify-center hover:bg-gray-100 transition duration-200">
                    {language === 'zh-HK' ? 'é»æ“Šç°½åæˆ–ä¸Šå‚³åœ–ç‰‡' : language === 'zh-CN' ? 'ç‚¹å‡»ç­¾åæˆ–ä¸Šä¼ å›¾ç‰‡' : 'Click to Sign or Upload Image'}
                  </button>
                </div>
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">
                    {language === 'zh-HK' ? 'å®¶é•·/ç›£è­·äººç°½ç½²' : language === 'zh-CN' ? 'å®¶é•¿/ç›‘æŠ¤äººç­¾ç½²' : 'Signature of Parent/Guardian'}
                  </label>
                  <button onClick={() => alert('ç°½åæ¿åŠŸèƒ½ - æ•¬è¯·æœŸå¾…ï¼')} className="w-full bg-white border border-gray-300 rounded-lg py-8 text-gray-400 flex items-center justify-center hover:bg-gray-100 transition duration-200">
                    {language === 'zh-HK' ? 'é»æ“Šç°½åæˆ–ä¸Šå‚³åœ–ç‰‡' : language === 'zh-CN' ? 'ç‚¹å‡»ç­¾åæˆ–ä¸Šä¼ å›¾ç‰‡' : 'Click to Sign or Upload Image'}
                  </button>
                </div>
                <div className="md:col-span-2">
                  <label className="block text-sm font-medium text-gray-700 mb-1">
                    {language === 'zh-HK' ? 'å®¶é•·/ç›£è­·äººå§“å' : language === 'zh-CN' ? 'å®¶é•¿/ç›‘æŠ¤äººå§“å' : 'Name of Parent/Guardian'}
                  </label>
                  <input
                    type="text"
                    className={`w-full p-2 border rounded-lg focus:ring-primary focus:border-primary transition duration-200 ${formData.sections[1].fields.find(f => f.id === 'father_name_zh')?.value ? 'bg-highlight border-secondary' : 'border-gray-300'}`}
                    value={formData.sections[1].fields.find(f => f.id === 'father_name_zh')?.value || ''}
                    onChange={(e) => handleFieldChange('parent_info', 'father_name_zh', e.target.value)} // Assuming father is guardian for demo
                  />
                </div>
                <div className="md:col-span-2">
                  <label className="block text-sm font-medium text-gray-700 mb-1">
                    {language === 'zh-HK' ? 'æ—¥æœŸ' : language === 'zh-CN' ? 'æ—¥æœŸ' : 'Date'}
                  </label>
                  <input
                    type="date"
                    className="w-full p-2 border rounded-lg focus:ring-primary focus:border-primary transition duration-200 bg-highlight border-secondary"
                    value="2025-07-11" // Mock current date
                    onChange={() => {}} // Not editable for demo
                  />
                </div>
              </div>
            </div>

          </div>
        </div>

        {/* Right Smart Assistant/Input Area */}
        <div className="w-1/4 bg-white p-6 border-l border-gray-200 overflow-y-auto shadow-md">
          <h3 className="text-xl font-semibold text-text mb-4">
            {language === 'zh-HK' ? 'æ™ºèƒ½åŠ©æ‰‹' : language === 'zh-CN' ? 'æ™ºèƒ½åŠ©æ‰‹' : 'Smart Assistant'}
          </h3>
          <div className="mb-6">
            <label className="block text-sm font-medium text-gray-700 mb-2">
              {language === 'zh-HK' ? 'è‡ªç„¶èªè¨€è¼¸å…¥' : language === 'zh-CN' ? 'è‡ªç„¶è¯­è¨€è¾“å…¥' : 'Natural Language Input'}
            </label>
            <textarea
              className="w-full p-3 border border-gray-300 rounded-lg focus:ring-primary focus:border-primary transition duration-200"
              rows="6"
              placeholder={language === 'zh-HK' ? 'è«‹æè¿°æ‚¨çš„ä¿¡æ¯ï¼Œå¦‚ï¼šæˆ‘å…’å­å«å¼µå‰ï¼Œ2009å¹´3æœˆ4æ—¥å‡ºç”Ÿ...' : language === 'zh-CN' ? 'è¯·æè¿°æ‚¨çš„ä¿¡æ¯ï¼Œå¦‚ï¼šæˆ‘å„¿å­å«å¼ ä¼Ÿï¼Œ2009å¹´3æœˆ4æ—¥å‡ºç”Ÿ...' : 'Describe your information, e.g., My son is John, born on March 4, 2009...'}
              value={smartInput}
              onChange={handleSmartInputChange}
            ></textarea>
            <button
              onClick={handleExtractAndFill}
              className="mt-3 w-full bg-primary text-white py-2 rounded-lg font-semibold hover:bg-primary-dark transition duration-200 shadow-md"
            >
              {language === 'zh-HK' ? 'AI è‡ªå‹•å¡«å……' : language === 'zh-CN' ? 'AI è‡ªåŠ¨å¡«å……' : 'AI Auto-Fill'}
            </button>
          </div>

          {extractedInfo.length > 0 && (
            <div className="mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200">
              <h4 className="text-lg font-semibold text-blue-800 mb-3">
                {language === 'zh-HK' ? 'AI æå–ä¿¡æ¯' : language === 'zh-CN' ? 'AI æå–ä¿¡æ¯' : 'AI Extracted Info'}
              </h4>
              {extractedInfo.map((item, index) => (
                <div key={index} className="flex justify-between items-center text-sm text-blue-700 mb-1">
                  <span>{item.label}:</span>
                  <span className="font-medium">{item.value}</span>
                  <button onClick={() => alert('ç¼–è¾‘æå–ä¿¡æ¯ - æ•¬è¯·æœŸå¾…ï¼')} className="text-blue-500 hover:text-blue-700 ml-2">
                    <svg xmlns="http://www.w3.org/2000/svg" className="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" />
                    </svg>
                  </button>
                </div>
              ))}
            </div>
          )}

          <div className="mb-6 p-4 bg-yellow-50 rounded-lg border border-yellow-200">
            <h4 className="text-lg font-semibold text-yellow-800 mb-3">
              {language === 'zh-HK' ? 'å¸¸è¦‹å•é¡Œ/ç¼ºå¤±ä¿¡æ¯æç¤º' : language === 'zh-CN' ? 'å¸¸è§é—®é¢˜/ç¼ºå¤±ä¿¡æ¯æç¤º' : 'Common Issues/Missing Info'}
            </h4>
            {unfilledFields.length === 0 ? (
              <p className="text-sm text-yellow-700">{language === 'zh-HK' ? 'è¡¨æ ¼å·²åŸºæœ¬å¡«å¯«å®Œæ•´ï¼Œè«‹ä»”ç´°æ ¡å°ã€‚' : language === 'zh-CN' ? 'è¡¨æ ¼å·²åŸºæœ¬å¡«å†™å®Œæ•´ï¼Œè¯·ä»”ç»†æ ¡å¯¹ã€‚' : 'Form is mostly complete, please review carefully.'}</p>
            ) : (
              <ul className="list-disc pl-5 text-sm text-yellow-700">
                {unfilledFields.slice(0, 3).map((field, index) => (
                  <li key={index} className="mb-1">
                    {language === 'zh-HK' ? 'è«‹å¡«å¯«' : language === 'zh-CN' ? 'è¯·å¡«å†™' : 'Please fill in'}: {field.label} ({field.sectionTitle})
                  </li>
                ))}
                {unfilledFields.length > 3 && (
                  <li className="text-yellow-700">... {language === 'zh-HK' ? 'é‚„æœ‰æ›´å¤š' : language === 'zh-CN' ? 'è¿˜æœ‰æ›´å¤š' : 'more'}</li>
                )}
              </ul>
            )}
          </div>
        </div>
      </div>

      {/* Bottom Action Bar */}
      <div className="bg-white shadow-lg py-4 px-6 flex justify-between items-center border-t border-gray-200 rounded-t-lg">
        <button onClick={() => alert('ä¿å­˜æˆåŠŸï¼')} className="bg-gray-200 text-text py-2 px-4 rounded-lg font-semibold hover:bg-gray-300 transition duration-200">
          {language === 'zh-HK' ? 'ä¿å­˜è‰ç¨¿' : language === 'zh-CN' ? 'ä¿å­˜è‰ç¨¿' : 'Save Draft'}
        </button>
        <div className="flex space-x-4">
          <button onClick={() => alert('äººå·¥å¯©æ ¸æœå‹™ - æ•¬è«‹æœŸå¾…ï¼')} className="bg-secondary text-white py-2 px-4 rounded-lg font-semibold hover:bg-blue-600 transition duration-200 shadow-md">
            {language === 'zh-HK' ? 'äººå·¥å¯©æ ¸' : language === 'zh-CN' ? 'äººå·¥å®¡æ ¸' : 'Human Review'}
          </button>
          <button onClick={() => setView('exportPrint')} className="bg-accent text-white py-2 px-4 rounded-lg font-semibold hover:bg-orange-600 transition duration-300 shadow-md">
            {language === 'zh-HK' ? 'å°å‡º/æ‰“å°' : language === 'zh-CN' ? 'å¯¼å‡º/æ‰“å°' : 'Export/Print'}
          </button>
        </div>
      </div>
    </div>
  );
};

// Export/Print Component (Simplified for prototype)
const ExportPrint = ({ setView, language }) => {
  const [format, setFormat] = useState('pdf');

  return (
    <div className="p-8 bg-gray-50 min-h-screen font-sans flex items-center justify-center">
      <div className="bg-white p-10 rounded-xl shadow-lg border border-gray-200 max-w-2xl w-full">
        <h2 className="text-3xl font-semibold text-primary mb-8 text-center">
          {language === 'zh-HK' ? 'å°å‡ºèˆ‡æ‰“å°' : language === 'zh-CN' ? 'å¯¼å‡ºä¸æ‰“å°' : 'Export & Print'}
        </h2>

        <div className="mb-6">
          <label className="block text-lg font-medium text-gray-700 mb-3">
            {language === 'zh-HK' ? 'é¸æ“‡å°å‡ºæ ¼å¼' : language === 'zh-CN' ? 'é€‰æ‹©å¯¼å‡ºæ ¼å¼' : 'Select Export Format'}
          </label>
          <div className="flex space-x-6">
            <label className="inline-flex items-center">
              <input
                type="radio"
                className="form-radio text-primary h-5 w-5"
                name="exportFormat"
                value="pdf"
                checked={format === 'pdf'}
                onChange={(e) => setFormat(e.target.value)}
              />
              <span className="ml-2 text-lg text-text">PDF ({language === 'zh-HK' ? 'é«˜æ¸…æ‰“å°ç‰ˆ' : language === 'zh-CN' ? 'é«˜æ¸…æ‰“å°ç‰ˆ' : 'High-Res Print'})</span>
            </label>
            <label className="inline-flex items-center">
              <input
                type="radio"
                className="form-radio text-primary h-5 w-5"
                name="exportFormat"
                value="image"
                checked={format === 'image'}
                onChange={(e) => setFormat(e.target.value)}
              />
              <span className="ml-2 text-lg text-text">PNG/JPG ({language === 'zh-HK' ? 'åœ–ç‰‡æ ¼å¼' : language === 'zh-CN' ? 'å›¾ç‰‡æ ¼å¼' : 'Image Format'})</span>
            </label>
          </div>
        </div>

        <div className="mb-8">
          <label className="block text-lg font-medium text-gray-700 mb-3">
            {language === 'zh-HK' ? 'åˆ†äº«è¨­ç½®' : language === 'zh-CN' ? 'åˆ†äº«è®¾ç½®' : 'Share Settings'}
          </label>
          <div className="flex items-center">
            <input type="checkbox" className="form-checkbox h-5 w-5 text-primary rounded" />
            <span className="ml-2 text-lg text-text">{language === 'zh-HK' ? 'ç”Ÿæˆåˆ†äº«éˆæ¥ (å¯è¨­ç½®å¯†ç¢¼)' : language === 'zh-CN' ? 'ç”Ÿæˆåˆ†äº«é“¾æ¥ (å¯è®¾ç½®å¯†ç )' : 'Generate Shareable Link (with password option)'}</span>
          </div>
        </div>

        <div className="text-center">
          <button
            onClick={() => alert(`${language === 'zh-HK' ? 'å·²ç”Ÿæˆ' : language === 'zh-CN' ? 'å·²ç”Ÿæˆ' : 'Generated'} ${format.toUpperCase()} ${language === 'zh-HK' ? 'æ–‡ä»¶ï¼' : language === 'zh-CN' ? 'æ–‡ä»¶ï¼' : 'file!'}`)}
            className="bg-accent text-white py-3 px-8 rounded-lg text-xl font-bold shadow-md hover:bg-orange-600 transition duration-300 ease-in-out transform hover:scale-105 mr-4"
          >
            {language === 'zh-HK' ? 'ç¢ºèªå°å‡º' : language === 'zh-CN' ? 'ç¡®è®¤å¯¼å‡º' : 'Confirm Export'}
          </button>
          <button
            onClick={() => setView('formFilling')}
            className="bg-gray-300 text-gray-800 py-3 px-8 rounded-lg text-xl font-bold shadow-md hover:bg-gray-400 transition duration-300 ease-in-out transform hover:scale-105"
          >
            {language === 'zh-HK' ? 'è¿”å›' : language === 'zh-CN' ? 'è¿”å›' : 'Back'}
          </button>
        </div>
      </div>
    </div>
  );
};

// Footer Component
const Footer = ({ language }) => {
  return (
    <footer className="bg-primary text-white py-6 px-6 text-center text-sm rounded-t-lg shadow-inner">
      <div className="max-w-7xl mx-auto">
        <p className="mb-2">
          &copy; {new Date().getFullYear()} Form.AI 2.0. {language === 'zh-HK' ? 'ç‰ˆæ¬Šæ‰€æœ‰ã€‚' : language === 'zh-CN' ? 'ç‰ˆæƒæ‰€æœ‰ã€‚' : 'All rights reserved.'}
        </p>
        <p className="mb-2">
          {language === 'zh-HK' ? 'ç”± [æ‚¨çš„å…¬å¸åç¨±] é–‹ç™¼ã€‚' : language === 'zh-CN' ? 'ç”± [æ‚¨çš„å…¬å¸åç§°] å¼€å‘ã€‚' : 'Developed by [Your Company Name].'}
        </p>
        <div className="flex justify-center space-x-4 mt-3">
          <a href="#" className="text-white hover:text-secondary transition duration-200">
            {language === 'zh-HK' ? 'é—œæ–¼æˆ‘å€‘' : language === 'zh-CN' ? 'å…³äºæˆ‘ä»¬' : 'About Us'}
          </a>
          <span className="text-gray-400">|</span>
          <a href="#" className="text-white hover:text-secondary transition duration-200">
            {language === 'zh-HK' ? 'ç§éš±æ”¿ç­–' : language === 'zh-CN' ? 'éšç§æ”¿ç­–' : 'Privacy Policy'}
          </a>
          <span className="text-gray-400">|</span>
          <a href="#" className="text-white hover:text-secondary transition duration-200">
            {language === 'zh-HK' ? 'æœå‹™æ¢æ¬¾' : language === 'zh-CN' ? 'æœåŠ¡æ¡æ¬¾' : 'Terms of Service'}
          </a>
        </div>
      </div>
    </footer>
  );
};

// Main App Component
export default function App() {
  const [currentView, setCurrentView] = useState('dashboard'); // 'dashboard', 'templateLibrary', 'formFilling', 'exportPrint'
  const [language, setLanguage] = useState('zh-HK'); // 'zh-HK', 'zh-CN', 'en'

  const renderView = () => {
    switch (currentView) {
      case 'dashboard':
        return <Dashboard setView={setCurrentView} language={language} />;
      case 'templateLibrary':
        return <TemplateLibrary setView={setCurrentView} language={language} />;
      case 'formFilling':
        return <FormFilling setView={setCurrentView} language={language} />;
      case 'exportPrint':
        return <ExportPrint setView={setCurrentView} language={language} />;
      default:
        return <Dashboard setView={setCurrentView} language={language} />;
    }
  };

  return (
    <div className="min-h-screen flex flex-col">
      <Header currentView={currentView} setView={setCurrentView} language={language} setLanguage={setLanguage} />
      <main className="flex-1 overflow-auto">
        {renderView()}
      </main>
      <Footer language={language} /> {/* Added Footer component here */}
    </div>
  );
}
